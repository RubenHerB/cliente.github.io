<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html"; charset="utf-8" />
        <title>Lista</title>
        <script type="text/javascript" src="preguntas.js"></script>
        <style>
            button {margin-left: 5px; margin-right: 5px}
        </style>
    </head>
    <body>
        <h1>Test de javascript</h1>
        <form id="test">
        <div id="preguntas"></div>
        </form>
        <br>
        <button onclick="comprobar()">Comprobar respuestas</button>
        <h2 id="resultado"></h2>
        
        <script type="text/javascript">
            var output = document.getElementById("preguntas");
            function preguntasshufle(obj){
                console.log(obj.verdadera);
                var res=[ obj.verdadera, obj.falsa1, obj.falsa2, obj.falsa3];
                return res.sort((a, b) => 0.5 - Math.random());
            }

            for (var i=0; i<preguntas.length; i++) {
                output.innerHTML+="<div><fieldset id=\"pregunta"+i+"\"><legend>"+preguntas[i].pregunta+"</legend></fieldset><div id=\"res"+i+"\"></div></div>";

                var p=preguntasshufle(preguntas[i]);   
                for (var j=0 ; j<p.length ; j++) {
                    document.getElementById("pregunta"+i).innerHTML+="<input type=\"radio\" name=\"p"+i+"\" id=\""+i+"p"+j+"\"  value=\""+p[j]+"\"><label for=\""+i+"p"+j+"\">"+p[j]+"</label><br>";
                }

                if (i<(preguntas.length-1)){
                    output.innerHTML+="<hr>"
                }
            }

            function comprobar(){
                var nota=0;
                var res="";
                for (var i=0; i<preguntas.length; i++) {

                    var radios = document.getElementsByName('p'+i);
                    for (var j = 0, length = radios.length; j < length; j++) {
                    if (radios[j].checked) {

                    res=radios[j].value;

                    break;
                    }
                        }

                    console.log(res);
                    
                    if (res===preguntas[i].verdadera){
                        document.getElementById("res"+i).innerHTML="Respuesta correcta";
                        document.getElementById("res"+i).style.color="lightgreen";
                        nota++;
                    }else{
                        document.getElementById("res"+i).innerHTML="Respuesta incorrecta, la respuesta correcta era: "+preguntas[i].verdadera;
                        document.getElementById("res"+i).style.color="red";
                    }
                }
                document.getElementById("resultado").innerHTML="Tu nota es: "+nota+"/10, estas "+(nota>=5?"aprobado":"suspenso");
            }
        </script>
    </body>
</html>